import torch
from dataset import de_preprocess,train_dataset,BOS_IDX,EOS_IDX,UNK_IDX,PAD_IDX,en_vocab,de_vocab
from config import DEVICE,SEQ_MAX_LEN
from transformer import Transformer
import time
# de翻译到en
def translate(transformer,de_sentence,page_id):
    # De分词
    de_tokens,de_ids=de_preprocess(de_sentence)
    if len(de_tokens)>SEQ_MAX_LEN:
        raise Exception('不支持超过{}的句子'.format(SEQ_MAX_LEN))

    # Encoder阶段
    enc_x_batch=torch.tensor([de_ids],dtype=torch.long).to(DEVICE)      # 准备encoder输入
    #encoder_z=transformer.encode(enc_x_batch)    # encoder编码
    
    # Decoder阶段
    transformer.decoder.open_kvcache() # 开启KV Cache

    en_token_ids=[BOS_IDX]
    #de_ids.copy()# 翻译结果

   #print(f'KV={transformer.decoder.decoder_blocks.second_multihead_attn.kv_cache.cpu}')
    #print(f"{en_token_ids},{enc_x_batch}")
    while len(en_token_ids)<SEQ_MAX_LEN:
        if  en_token_ids == [BOS_IDX]:
           prefill = True
        else:
            prefill = False
        dec_x_batch=torch.tensor([en_token_ids],dtype=torch.long).to(DEVICE)  # 准备decoder输入
        decoder_z=transformer.decode(dec_x_batch,enc_x_batch,prefill)#,page_id)   # decoder解碼
        next_token_probs=decoder_z[0,dec_x_batch.size(-1)-1,:]    # 序列下一个词的概率
        next_token_id=torch.argmax(next_token_probs)    # 下一个词ID
        en_token_ids.append(next_token_id)
        #print(f"{en_token_ids},{enc_x_batch}")
        if next_token_id==EOS_IDX and len(en_token_ids)>=len(de_tokens):  # 结束符
            break

        
    transformer.decoder.close_kvcache() # 清理KV Cache
    
    # 生成翻译结果
    en_token_ids=[id for id in en_token_ids if id not in [BOS_IDX,EOS_IDX,UNK_IDX,PAD_IDX]] # 忽略特殊字符
    en_tokens=en_vocab.lookup_tokens(en_token_ids)    # 词id序列转token序列
    return ' '.join(en_tokens)

if __name__=='__main__':
    start_time = time.time()
    # 加载模型
    transformer=Transformer(enc_vocab_size=len(de_vocab),dec_vocab_size=len(en_vocab),emb_size=512,q_k_size=64,v_size=64,f_size=2048,head=8,nblocks=6,dropout=0.1,seq_max_len=SEQ_MAX_LEN).to(DEVICE)
    transformer.load_state_dict(torch.load('checkpoints/model.pth'))
    transformer.eval()
    #en=translate(transformer,'Das Leben ist schön, wenn')
     
    #1M
    en=translate(transformer,'Das Leben ist schön, wenn man die kleinen Dinge schätzt.Das Leben ist schön, wenn man die kleinen Dinge schätzt.',11)
    print(en)
   # en=translate(transformer,'Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,Das Leben ist schön, Das Leben ist schön,Das Leben ist schön,')
    #en=translate(transformer,'Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die kleinen Dinge schätzt, ')
    #1GB 
    #en=translate(transformer,'Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die')
    #2GB 
    #en=translate(transformer,'Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDasön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön,')
    #5GB 
    #en=translate(transformer,'Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDasön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDasön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt,Das Leben ist schön, wenn man die kleinen Dinge schätzt')
    #10GB 
    #en=translate(transformer,'Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDasön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDasön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt,Das Leben ist schön, wenn man die kleinen Dinge schätzt Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDasön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDasön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt,Das Leben ist schön, wenn man die kleinen Dinge schätzt')
    #20GB en=translate(transformer,'Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDasön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDasön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt,Das Leben ist schön, wenn man die kleinen Dinge schätzt Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDasön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDasön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt,Das Leben ist schön, wenn man die kleinen Dinge schätzt Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDasön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDasön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt,Das Leben ist schön, wenn man die kleinen Dinge schätzt Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDasön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDas Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön, wenn man dieDasön, wenn man die Das Leben ist schön, wenn man die kleinen Dinge schätzt, Das Leben ist schön,Das Leben ist schön, wenn man die kleinen Dinge schätzt,Das Leben ist schön, wenn man die kleinen Dinge schätzt')
    
#    print(en)
    
    


    # 测试数据
   # for i in range(10):
    #   de,en=train_dataset[i]
    #   en1=translate(transformer,de)
   #    print('{} -> {} -> {}'.format(de,en,en1))
   
    end_time = time.time()  # 记录结束时间
    total_time = end_time - start_time  # 计算总时间
    print(f"Translation completed in {total_time:.4f} seconds")  # 输出时间